# DigitalOcean Managed Database Configuration
# Copy to .env and update with your DigitalOcean Database details

# Domain Configuration
DOMAIN=yourdomain.com
LETSENCRYPT_EMAIL=admin@yourdomain.com

# DigitalOcean Managed Database Configuration
# Format: postgresql://username:password@host:port/database?sslmode=require
DATABASE_URL=postgresql://doadmin:your_password@db-postgresql-nyc1-12345-do-user-1234567-0.b.db.ondigitalocean.com:25060/defaultdb?sslmode=require

# Alternative individual components (if not using DATABASE_URL)
PGHOST=db-postgresql-nyc1-12345-do-user-1234567-0.b.db.ondigitalocean.com
PGPORT=25060
PGDATABASE=defaultdb
PGUSER=doadmin
PGPASSWORD=your_secure_password
PGSSLMODE=require

# Security Configuration
SESSION_SECRET=your_secure_random_session_secret_min_32_characters
NODE_TLS_REJECT_UNAUTHORIZED=1

# DigitalOcean Managed Database Specific Settings
# 1. Database Cluster Configuration:
#    - Engine: PostgreSQL 15
#    - Plan: General Purpose
#    - Nodes: 1 (2 for high availability)
#    - Size: db-s-1vcpu-2gb (adjust as needed)
#    - Storage: 25 GB (scales automatically)
#    - Region: nyc1 (choose closest to your app)

# 2. Connection Pooling:
#    - Mode: Transaction
#    - Default pool size: 25
#    - Max client connections: 5000
#    - Pool mode: Transaction (recommended)

# 3. Backup and Recovery:
#    - Automated backups: Every 24 hours
#    - Backup retention: 7 days
#    - Point-in-time recovery: Available
#    - Maintenance window: Configurable

# 4. Security Configuration:
#    - SSL enforcement: Enabled
#    - Add your server IP to trusted sources
#    - Use VPC network for private connectivity

# 5. Performance Insights:
#    - Query performance metrics
#    - Connection statistics
#    - Resource utilization graphs
#    - Slow query log analysis

# 6. Eviction Policy (for connection pooling):
#    - Eviction policy: LRU (Least Recently Used)
#    - Eviction interval: 60 seconds
#    - Max lifetime: 3600 seconds

# 7. Firewall/Trusted Sources:
#    doctl databases firewalls append your-db-cluster-id \
#      --rule type:ip_addr,value:YOUR_SERVER_IP \
#      --rule type:ip_addr,value:YOUR_BACKUP_SERVER_IP

# 8. Connection Testing:
#    psql "postgresql://doadmin:your_password@your-host:25060/defaultdb?sslmode=require"

# Deployment Command:
# docker compose -f docker-compose.ssl-external-db.yml up -d --build